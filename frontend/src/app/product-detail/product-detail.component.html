<div class="product-detail" *ngIf="product; else loadingOrError">

  <div class="product-top">
    <!-- Image produit -->
    <img [src]="product.imageUrl?.trim() !== '' ? product.imageUrl : 'assets/default-product.jpg'"
         [alt]="product.title || 'Produit sans titre'"
         class="product-detail-image">

    <!-- Infos produit -->
    <div class="product-info">
      <h2>{{ product.title || 'Produit sans titre' }}</h2>

      <!-- âœ… Prix de la variation sÃ©lectionnÃ©e -->
      <p *ngIf="getSelectedPrice() !== null" class="price">
        Prix : {{ getSelectedPrice() }} â‚¬
      </p>
      <p *ngIf="getSelectedPrice() === null" class="price">
        Prix non disponible
      </p>

      <!-- SÃ©lecteur poids -->
      <label>Poids</label>
      <select [(ngModel)]="selectedVariationId">
        <option *ngFor="let variation of product.variations" [value]="variation.id">
          {{ variation.weight }} - {{ variation.price }} â‚¬
        </option>
      </select>

      <!-- QuantitÃ© -->
      <label>QuantitÃ©</label>
      <input type="number" min="1" [(ngModel)]="quantity" />

      <!-- Bouton -->
      <button class="add-to-cart-btn" (click)="addToCart()">
        Ajouter au panier ðŸ›’
      </button>
    </div>
  </div>

  <!-- Affiche le SKU -->
  <p *ngIf="getSelectedVariation()" class="sku">
    RÃ©f : {{ getSelectedVariation().sku }}
  </p>

  <!-- Description longue formatÃ©e -->
  <div class="long-description">
    <p [innerHTML]="formatDescription(product.description)"></p>
  </div>
</div>

<ng-template #loadingOrError>
  <p>{{ errorMessage || 'Chargement du produit...' }}</p>
</ng-template>
